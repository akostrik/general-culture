![Screenshot from 2024-03-08 14-58-54](https://github.com/akostrik/general-culture/assets/22834202/21c2e1af-1da8-441b-ae20-47201cf09d5e)

* nginx = **веб-сервер** (**HTTP-сервер**) обрабатывает запросы от клиентов по протоколам HTTP и HTTPS, возвращает ответ в виде HTML-страницы
* nginx = **прокси-сервер** принимает и обрабатывает запросы клиентов, передает их другим программам
* nginx = **обратный прокси-сервер** принимает результат работы других серверов, отдаёт его клиентам
* nginx = **SMTP/IMAP/POP3-прокси сервер** (**почтовый прокси-сервер**)
  + перенаправление пользователя на SMTP/IMAP/POP3-бэкенд
  + внешний HTTP-сервер аутентификации
  + аутентификация (LOGIN, USER/PASS)
  + поддержка SSL, STARTTLS
* nginx = **балансировщик нагрузки** распределяет сетевые запросы между серверами, следуя настройкам балансировки
* преимущества
  + простой, не перегруженный функциями
  + быстрый, нет проседания под нагрузкой, распределение нагрузки на серверную часть
  + отказоустойчивость
  + безопасность
* usage
  + обслуживание большого количества запросов одновременно
  + обслуживание неизменяемых запросов
  + обслуживание индексных файлов
  + обработка запросов с сайтов, где много статического контента
  + кеширование и стриминг видео
  + построение CDN-сетей
  + хостинг нескольких сайтов на одном сервере
  + SSL/TLS-терминация: Nginx поддерживает оба протокола, обеспечивая шифрование и дешифрование данных, поэтому его можно использовать в качестве посредника между клиентом и основным веб-сервером, снижая нагрузку на последний, при этом ещё улучшает безопасность
* настройки 
  + `etc/nginx/nginx.conf` глобальные 
  + `/etc/nginx/site-available`, `/etc/nginx/conf.d/` для конкретных сайтов
  + locations
    - отвечает за маршрутизацию запросов
    - конфигурация разделяется на виртуальные серверы
    - для виртуального сервера можно задать адреса, порты, имена
    - виртуальные серверы разделяются на locations
    - location 
       = locations могут задаваться точным URI, частью URI, регулярным выражением  
       = Locations могут быть сконфигурированы для обслуживания запросов из статического файла, проксирования на fastcgi/memcached сервер  
    - ищет совпадения HTTP-запроса с `server_name` и `listen` в контексте server -> ищет совпадения с условиями обработки `location` -> понимает, что нужно отдать клиенту
* как работает
  + у Nginx асинхронная архитектура, запросы обрабатываются на разных этапах -> скорость (до него  запросы каждого пользователя обрабатывались по отдельности => много процессов => медленно)
  + событийно-ориентированная обработка запросов => множество соединений без блокирования ввода и вывода
  + выполняются параллельно несколько подзапросов на одной странице, обрабатываемых в SSI-фильтре через прокси или FastCGI
  + 10,000 одновременных запросов, при этом минимум памяти + производительность
  + до 1024 запросов на одно сетевое соединение
  + событийная архитектура позволяет масштабироваться до сотен тысяч параллельных соединений, обрабатывает множество соединений в одном процессе
  + **Пул** = последовательность выделенных блоков динамической памяти. Если размер объекта превышает значение NGX_MAX_ALLOC_FROM_POOL либо длину блока, то он полностью выделяется из кучи => мелкие объекты выделяются быстро 
  + фиксированное число процессов => максимально эффективно использовать ресурсы сервера, оперативную память
  + запросы от пользователя разбиваются на маленькие структуры — сетевые соединения
  + разобранный запрос последовательно обрабатывается цепочкой модулей
  + после обработки соединения собираются в одном виртуальном контейнере, чтобы преобразоваться в единый первоначальный запрос, затем отправляются пользователю
  + ответ клиенту формируется в буферах, буфера объединяются в цепочки, в этой последовательности передаются клиенту
  + содержит модуль географической классификации клиентов по IP-адресу
  + автоматическое создание списка файлов, кэш дескрипторов открытых файлов
  + акселерированное проксирование без кэширования
  + простое распределение нагрузки
  + поддержка кеширования при акселерированном проксировании и FastCGI
  + акселерированная поддержка FastCGI и memcached-серверов
  + поддержка SSL, PSGI, WSGI, экспериментально встроенного Perl
  + модульная система => nginx может расширять свои функции
  + фильтры, в том числе сжатие (gzip), byte-ranges (докачка), chunked-ответы, HTTP-аутентификация, SSI-фильтр
  + рабочие процессы выполняют цикл обработки событий от дескрипторов
  + эффективные операции ввода-вывода (writev, sendfile)
* Apache его главный конкурент 
